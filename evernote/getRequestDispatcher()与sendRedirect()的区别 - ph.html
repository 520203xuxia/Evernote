<html>
<head>
  <title>getRequestDispatcher()与sendRedirect()的区别 - phpzxh - 博客园</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/305825 (zh-CN, DDL); Windows/10.0.16299 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="931"/>
<h1>getRequestDispatcher()与sendRedirect()的区别 - phpzxh - 博客园</h1>

<div>
<span><div><br/></div><div><h1>getRequestDispatcher()与sendRedirect()的区别</h1></div><div style="margin-top: 1em; margin-bottom: 1em;"><div>1.request.getRequestDispatcher()是请求转发，前后页面共享一个request ;</div><div>response.sendRedirect()是重新定向，前后页面不是一个request。</div></div><div style="margin-top: 1em; margin-bottom: 1em;">request.getRequestDispather();返回的是一个RequestDispatcher对象。</div><div style="margin-top: 1em; margin-bottom: 1em;"><div>2.RequestDispatcher.forward()是在服务器端运行;</div><div>HttpServletResponse.sendRedirect()是通过向客户浏览器发送命令来完成.</div><div>所以RequestDispatcher.forward()对于浏览器来说是“透明的”；</div><div>而HttpServletResponse.sendRedirect()则不是。</div></div><div style="margin-top: 1em; margin-bottom: 1em;">3.ServletContext.getRequestDispatcher(String url)中的url只能使用绝对路径； 而</div><div style="margin-top: 1em; margin-bottom: 1em;">ServletRequest.getRequestDispatcher(String url)中的url可以使用相对路径。因为</div><div style="margin-top: 1em; margin-bottom: 1em;">ServletRequest具有相对路径的概念；而ServletContext对象无次概念。</div><div style="margin-top: 1em; margin-bottom: 1em;">RequestDispatcher对象从客户端获取请求request，并把它们传递给服务器上的servlet,html或</div><div style="margin-top: 1em; margin-bottom: 1em;">jsp。它有两个方法:</div><div style="margin-top: 1em; margin-bottom: 1em;"><div>1.void forward(ServletRequest request,ServletResponse response)</div><div>用来传递request的，可以一个Servlet接收request请求，另一个Servlet用这个request请求来产生response。request传递的请求，response是客户端返回的信息。forward要在response到达客户端之前调用，也就是 before response body output has been flushed。如果不是的话，它会报出异常。</div></div><div style="margin-top: 1em; margin-bottom: 1em;"><div>2.void include(ServletRequest request,ServletResponse response)</div><div>用来记录保留request和response，以后不能再修改response里表示状态的信息。</div></div><div style="margin-top: 1em; margin-bottom: 1em;"><div>如果需要把请求转移到另外一个Web App中的某个地址，可以按下面的做法：</div><div>1. 获得另外一个Web App的ServletConext对象(currentServletContext.getContext(uripath)).</div><div><br/></div><div>2. 调用ServletContext.getRequestDispatcher(String url)方法。</div><div><br/></div><div>eg:ServletContext.getRequestDispatcher(&quot;smserror.jsp&quot;).forward(request,response);</div></div><div style="margin-top: 1em; margin-bottom: 1em;"><a href="http://lanew.blog.ccidnet.com/blog-htm-do-showone-type-blog-itemid-3690834-uid-327434.html" target="_blank" title="http://lanew.blog.ccidnet.com/blog-htm-do-showone-type-blog-itemid-3690834-uid-327434.html">http://lanew.blog.ccidnet.com/blog-htm-do-showone-type-blog-itemid-3690834-uid-327434.html</a></div><div>二者区别：</div><div>response.sendRedirect(url)跳转到指定的URL地址，产生一个新的request，所以要传递参数只有在url后加参</div><div>数，如：</div><div>url?id=1.</div><div>request.getRequestDispatcher(url).forward(request,response)是直接将请求转发到指定URL，所以该请求</div><div>能够直接获得上一个请求的数据，也就是说采用请求转发，request对象始终存在，不会重新创建。而</div><div>sendRedirect()会新建request对象，所以上一个request中的数据会丢失。</div><div>更具体来说就是这样的：</div><div>redirect 会首先发一个response给浏览器, 然后浏览器收到这个response后再发一个requeset给服务器, 然后</div><div>服务器发新的response给浏览器. 这时页面收到的request是一个新从浏览器发来的.</div><div>forward 发生在服务器内部, 在浏览器完全不知情的情况下发给了浏览器另外一个页面的response. 这时页面</div><div>收到的request不是从浏览器直接发来了,可能己经用request.setAttribute在request里放了数据.在转到的页</div><div>面可直接用request.getAttribute获得数据。</div><div>最基本的用法就如上了，其他的一些应注意的地方如下：</div><div>跳转方式</div><div><a href="http://localhost:8080/Test" target="_blank">http://localhost:8080/Test</a>应用</div><div>运用forward方法只能重定向到同一个Web应用程序中的一个资源。而sendRedirect方法可以让你重定向到任何</div><div>URL。</div><div>表单form的action=&quot;/uu&quot;;sendRedirect(&quot;/uu&quot;);表示相对于服务器根路径。如<a href="http://localhost:8080/Test" target="_blank">http://localhost:8080/Test</a>应</div><div>用（则提交至<a href="http://localhost:8080/uu" target="_blank">http://localhost:8080/uu</a>）;</div><div>Forward代码中的&quot;/uu&quot;则代表相对与WEB应用的路径。如<a href="http://localhost:8080/Test" target="_blank">http://localhost:8080/Test</a>应用（则提交至</div><div><a href="http://localhost:8080/Test/uu" target="_blank">http://localhost:8080/Test/uu</a>）;</div><div>（运用RequestDispatcher接口的Forward）方法</div><div>forward()无法重定向至有frame的jsp文件,可以重定向至有frame的html文件,</div><div>同时forward()无法在后面带参数传递,比如servlet?name=frank,这样不行,可以程序内通过</div><div>response.setAttribute(&quot;name&quot;,name)来传至下一个页面.</div><div>重定向后浏览器地址栏URL不变.</div><div>只有在客户端没有输出时才可以调用forward方法。如果当前页面的缓冲区（buffer）不是空的，那么你在调用</div><div>forward方法前必须先清空缓冲区。</div><div>&quot;/&quot;代表相对与web应用路径</div><div>RequestDispatcher rd = request.getRequestDispatcher(&quot;/ooo&quot;);</div><div>rd.forward(request, response);提交至<a href="http://localhost:8080/Test/ooo" target="_blank">http://localhost:8080/Test/ooo</a></div><div>RequestDispatcher rd = getServletContext().getRequestDispatcher(&quot;/ooo&quot;);</div><div>rd.forward(request, response);提交至<a href="http://localhost:8080/Test/ooo" target="_blank">http://localhost:8080/Test/ooo</a></div><div>RequestDispatcher rd =getServletContext().getNamedDispatcher(&quot;TestServlet&quot;);（TestServlet为一个</div><div>&lt;servlet-name&gt;）</div><div>rd.forward(request, response);提交至名为TestServlet的servlet</div><div>如果在&lt;jsp:forward&gt;之前有很多输出,前面的输出已使缓冲区满,将自动输出到客户端,那么该语句将不起作用,</div><div>这一点应该特别注意。</div><div>另外要注意：它不能改变浏览器地址，刷新的话会导致重复提交</div><div>从<a href="http://localhost:8080/Test/gw/page.jsp" target="_blank">http://localhost:8080/Test/gw/page.jsp</a>中转发</div><div>&lt;jsp:forward page=&quot;OtherPage.jsp&quot;/&gt;在JSP页面被解析后转换成pageContext.forward(&quot;OtherPage.jsp&quot;);</div><div>&quot;/OtherPage.jsp&quot;提交到<a href="http://localhost:8080/Test/OtherPage.jsp" target="_blank">http://localhost:8080/Test/OtherPage.jsp</a></div><div>&quot;OtherPage.jsp&quot;提交到<a href="http://localhost:8080/Test/gw/OtherPage.jsp" target="_blank">http://localhost:8080/Test/gw/OtherPage.jsp</a></div><div>(运用HttpServletResponse接口的sendRedirect）方法302</div><div>是在用户的浏览器端工作,sendRedirect()可以带参数传递,比如servlet?name=frank传至下个页面,</div><div>同时它可以重定向至不同的主机上,sendRedirect()可以重定向有frame.的jsp文件.</div><div>假设转发代码包含于注册的servlet－url为/ggg/tt;jsp为/ggg/tt.jsp:</div><div>绝对路径：response.sendRedirect(&quot;<a href="http://www.brainysoftware.com/" target="_blank">http://www.brainysoftware.com</a></div><div>根路径：response.sendRedirect(&quot;/ooo&quot;)发送至<a href="http://localhost:8080/ooo" target="_blank">http://localhost:8080/ooo</a></div><div>相对路径：response.sendRedirect(&quot;ooo&quot;)发送至<a href="http://localhost:8080/Test/ggg/ooo" target="_blank">http://localhost:8080/Test/ggg/ooo</a>,</div><div>sendRedirect等同于此方式</div><div>response.setStatus(HttpServletResponse.SC_MOVED_PERMANENTLY);</div><div>String newLocn = &quot;/newpath/jsa.jsp&quot;;</div><div>response.setHeader(&quot;Location&quot;,newLocn);</div><div>(Meta Refresh)方法200</div><div>这种方法是由HTML提供的，Meta本身就是HTML标签。使用方法是：&lt;meta http-equiv=&quot;refresh&quot; content=&quot;5;</div><div>url=http://www.dreamdu.com/&quot; /&gt;</div><div>相应的java代码</div><div>String content=stayTime+&quot;;URL=&quot;+URL;</div><div>response.setHeader(&quot;REFRESH&quot;,content);</div><div>------------------------------------------------------------------------------------------------</div><div>--------------------------</div><div>使用response.sendRedirect()地址栏将改变</div><div>使用request.getRequestDispatcher().forward(request,response)地址栏中的信息保持不变.</div><div>------------------------------------------------------------------------------------------------</div><div>--------------------------</div><div>request.setAttribute存的东西</div><div>只用通过方法2跳转 才能在新页取出来</div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 