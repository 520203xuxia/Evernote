<html>
<head>
  <title>webpack与实际项目的运用</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/305825 (zh-CN, DDL); Windows/10.0.16299 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="402"/>
<h1>webpack与实际项目的运用</h1>

<div>
<span><div><div style="text-align: center;"><span style="font-size: 14pt;">webpack与实际项目的运用</span></div><div><ol start="1"><li>新建项目文件夹webpack-real-project-&gt;npm init-&gt;npm install -g webpack-&gt;npm install webpack --save-dev,新建src目录放原代码，dist目录放打包的静态文件</li><li>目录文件结构如下：</li></ol><div>        <img src="webpack与实际项目的运用_files/Image.png" type="image/png" data-filename=""/><img src="webpack与实际项目的运用_files/Image [1].png" type="image/png" data-filename=""/></div></div><div><img src="webpack与实际项目的运用_files/Image [2].png" type="image/png" data-filename=""/></div><div>或者</div><div><img src="webpack与实际项目的运用_files/Image [3].png" type="image/png" data-filename=""/></div><div>打包后：</div><div><img src="webpack与实际项目的运用_files/Image [4].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [5].png" type="image/png" data-filename=""/></div><div>或者：</div><div><img src="webpack与实际项目的运用_files/Image [6].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [7].png" type="image/png" data-filename=""/></div><div>或者：</div><div><img src="webpack与实际项目的运用_files/Image [8].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [9].png" type="image/png" data-filename=""/></div><div><br/></div><div><ol start="3"><li>在index.html文件中，引用了打包后的js文件，如果js文件的文件名是hash值时，则是不确定的，那么如何引用呢</li></ol><div>        执行如下命令：</div></div><div><img src="webpack与实际项目的运用_files/Image [10].png" type="image/png" data-filename=""/></div><div>如何使用呢？在webpack.config.js文件中添加：</div><div><img src="webpack与实际项目的运用_files/Image [11].png" type="image/png" data-filename=""/></div><div>在命令行执行webpack命令之后，查看index.html文件</div><div><img src="webpack与实际项目的运用_files/Image [12].png" type="image/png" data-filename=""/></div><div>但是生成的index.html是在dist/js目录下：</div><div><img src="webpack与实际项目的运用_files/Image [13].png" type="image/png" data-filename=""/></div><div>如何满足项目需求呢？</div><div>指定模板，发现生成的index.html文件是在模板的基础上生成的</div><div><img src="webpack与实际项目的运用_files/Image [14].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [15].png" type="image/png" data-filename=""/></div><div><br/></div><div>修改输出目录</div><div><img src="webpack与实际项目的运用_files/Image [16].png" type="image/png" data-filename=""/></div><div>此时index.html在dist目录下了</div><div><img src="webpack与实际项目的运用_files/Image [17].png" type="image/png" data-filename=""/></div><div>指定名字：</div><div><img src="webpack与实际项目的运用_files/Image [18].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [19].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [20].png" type="image/png" data-filename=""/></div><div><br/></div><div><ol start="4"><li>自动生成html页面</li></ol><div>        在webpack.config.js文件中，</div><div>            <img src="webpack与实际项目的运用_files/Image [21].png" type="image/png" data-filename=""/></div><div>        那么在模板index.html中，如何引用title呢，如下</div></div><div>            <img src="webpack与实际项目的运用_files/Image [22].png" type="image/png" data-filename=""/></div><div>        那么新生成的index.html的title会被更新</div><div>        <img src="webpack与实际项目的运用_files/Image [23].png" type="image/png" data-filename=""/></div><div><br/></div><div>        <img src="webpack与实际项目的运用_files/Image [24].png" type="image/png" data-filename=""/></div><div>        </div><div>        <img src="webpack与实际项目的运用_files/Image [25].png" type="image/png" data-filename=""/></div><div>    </div><div><img src="webpack与实际项目的运用_files/Image [26].png" type="image/png" data-filename=""/></div><div><br/></div><div><img src="webpack与实际项目的运用_files/Image [27].png" type="image/png" data-filename=""/></div><div>可以在这个网站 <a href="https://www.npmjs.com/">https://www.npmjs.com/</a> 查看插件的详细信息</div><div><br/></div><div><br/></div><div><ol start="5"><li>如何实现有的js文件放在head中，有的放在body中</li></ol><div>              webpack.config.js中</div><div>            <img src="webpack与实际项目的运用_files/Image [28].png" type="image/png" data-filename=""/></div></div><div>        模板文件中：</div><div>        <img src="webpack与实际项目的运用_files/Image [29].png" type="image/png" data-filename=""/></div><div><br/></div><div><ol start="6"><li>为满足上线需求给引入的js文件一个路径</li></ol><div>        <img src="webpack与实际项目的运用_files/Image [30].png" type="image/png" data-filename=""/></div></div><div>        webpack之后，就会给js文件的路径加上以publicPath开头的绝对路径</div><div>        <img src="webpack与实际项目的运用_files/Image [31].png" type="image/png" data-filename=""/></div><div>        </div><div>        对生成的html文件进行压缩</div><div>        <img src="webpack与实际项目的运用_files/Image [32].png" type="image/png" data-filename=""/></div><div>        <img src="webpack与实际项目的运用_files/Image [33].png" type="image/png" data-filename=""/></div><div><br/></div><div><ol start="7"><li>多页面应用</li></ol></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><img src="webpack与实际项目的运用_files/Image [34].png" type="image/png" data-filename=""/></div></blockquote><div>            模板html如下：</div><div>            <img src="webpack与实际项目的运用_files/Image [35].png" type="image/png" data-filename=""/></div><div>            </div><div>            但似乎每次都要指定chunks太麻烦了，使用excludeChunks，除了某某文件</div><div>            <img src="webpack与实际项目的运用_files/Image [36].png" type="image/png" data-filename=""/></div><div><br/></div><div><br/></div><div><ol start="8"><li>提高页面性能，将初始化脚本嵌入页面，而不是以链接的形式引入，因为这样会增加HTTP请求</li></ol></div><div>            <img src="webpack与实际项目的运用_files/Image [37].png" type="image/png" data-filename=""/></div><div>            <img src="webpack与实际项目的运用_files/Image [38].png" type="image/png" data-filename=""/></div><div>            <img src="webpack与实际项目的运用_files/Image [39].png" type="image/png" data-filename=""/></div><div><br/></div><div>                然后再使用compilation，就可以直接将js的内容嵌入script标签中</div><div>                <img src="webpack与实际项目的运用_files/Image [40].png" type="image/png" data-filename=""/></div><div>                <img src="webpack与实际项目的运用_files/Image [41].png" type="image/png" data-filename=""/></div><div><br/></div><div>                此时我们发现，在body中也引入了main.js文件，这是因为我们的inject：&quot;body&quot;,当已经在head中引入main.js后，不需要再在body中引入，那么怎么做？</div><div>            <img src="webpack与实际项目的运用_files/Image [42].png" type="image/png" data-filename=""/></div><div>            <img src="webpack与实际项目的运用_files/Image [43].png" type="image/png" data-filename=""/></div><div><br/></div><div><br/></div><div style="text-align: center;"><span style="font-size: 16pt;">loader的学习</span></div><div><ol start="9"><li>新建目录文件如下</li></ol></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><img src="webpack与实际项目的运用_files/Image [44].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [45].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [46].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [47].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [48].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [49].png" type="image/png" data-filename=""/></div></blockquote><div><br/></div><div><br/></div><div><br/></div><div><ol start="10"><li>使用</li></ol></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><img src="webpack与实际项目的运用_files/Image [50].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [51].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [52].png" type="image/png" data-filename=""/></div><div>我的webpack.config.js这么设置的话，打包会出错，如果是这样就对了</div><div><img src="webpack与实际项目的运用_files/Image [53].png" type="image/png" data-filename=""/></div><div><br/></div><div><img src="webpack与实际项目的运用_files/Image [54].png" type="image/png" data-filename=""/></div><div><br/></div><div><br/></div><div><br/></div><div>或者可以在package.json中定义，</div><div><img src="webpack与实际项目的运用_files/Image [55].png" type="image/png" data-filename=""/></div></blockquote><div>            此时webpack之后就可以看见生成的index.html和main.bundle.js</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div>            如何写绝对路径：</div><div>            <img src="webpack与实际项目的运用_files/Image [56].png" type="image/png" data-filename=""/></div><div><br/></div><div><br/></div><div style="text-align: center;"><span style="font-size: 14pt;">处理项目中的css</span></div><div><br/></div><div><ol start="11"><li>安装：npm install style-loader css-loader --save-dev</li></ol></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><img src="webpack与实际项目的运用_files/Image [57].png" type="image/png" data-filename=""/></div></blockquote><div>            <img src="webpack与实际项目的运用_files/Image [58].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [59].png" type="image/png" data-filename=""/></div><div><br/></div><div><ol start="12"><li>配置</li></ol></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div>在webpack.config.js中配置loader</div><div><img src="webpack与实际项目的运用_files/Image [60].png" type="image/png" data-filename=""/></div><div>这样就可以打包了！！！</div><div><br/></div><div><br/></div></blockquote><div><ol start="13"><li>css的一些情况，添加浏览器前缀</li></ol></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div>先安装postcss-loader</div><div><img src="webpack与实际项目的运用_files/Image [61].png" type="image/png" data-filename=""/></div><div>再安装postcss的插件 autoprefixer</div><div><img src="webpack与实际项目的运用_files/Image [62].png" type="image/png" data-filename=""/></div><div>    新建postcss.config.js配置如下：</div><div><img src="webpack与实际项目的运用_files/Image [63].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [64].png" type="image/png" data-filename=""/></div><div>webpack.config.js配置如下：</div><div><img src="webpack与实际项目的运用_files/Image [65].png" type="image/png" data-filename=""/></div><div>然后打包就会自动添加前缀了</div><div><img src="webpack与实际项目的运用_files/Image [66].png" type="image/png" data-filename=""/></div><div><br/></div><div>如果在common.css中import进来一个文件，</div><div><img src="webpack与实际项目的运用_files/Image [67].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [68].png" type="image/png" data-filename=""/></div><div>此时打包，发现并没有为引入进来的文件自动添加前缀，且出现两个style标签</div><div><img src="webpack与实际项目的运用_files/Image [69].png" type="image/png" data-filename=""/></div><div>那么如何使能够自动为引入的文件的内容添加前缀呢？</div><div><img src="webpack与实际项目的运用_files/Image [70].png" type="image/png" data-filename=""/></div><div>这样就可以了</div><div><img src="webpack与实际项目的运用_files/Image [71].png" type="image/png" data-filename=""/></div><div><br/></div><div><br/></div><div style="text-align: center;"><span style="font-size: 14pt;">处理less文件</span></div><div><br/></div><div><br/></div></blockquote><div><ol start="14"><li>安装less、less-loader，install less --save-dev、install less-loader --save-dev</li><li>配置</li></ol></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><img src="webpack与实际项目的运用_files/Image [72].png" type="image/png" data-filename=""/></div><div>webpack打包即可。</div><div>检验postcss-loader是否生效：</div><div><img src="webpack与实际项目的运用_files/Image [73].png" type="image/png" data-filename=""/></div><div>成功：</div><div><img src="webpack与实际项目的运用_files/Image [74].png" type="image/png" data-filename=""/></div><div><br/></div><div>如果在less中import less文件，那么需不需要指定importLoaders的值呢？</div><div>答案是：不需要！</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div style="text-align: center;"><span style="font-size: 14pt;">处理sass文件</span></div><div><br/></div><div><br/></div></blockquote><div><ol start="16"><li>安装：npm install sass--loader --save-dev、npm install sass --save-dev</li><li>配置</li></ol></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><img src="webpack与实际项目的运用_files/Image [75].png" type="image/png" data-filename=""/></div></blockquote><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><br/></div><div><br/></div></blockquote><div style="text-align: center;"><div><span style="font-size: 14pt;">处理模板文件    </span><span style="font-size: 14pt;">    </span><span style="font-size: 14pt;">  </span>  </div></div><div><ol start="18"><li>安装loader</li></ol></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div>npm install html-loader --save-dev</div><div><img src="webpack与实际项目的运用_files/Image [76].png" type="image/png" data-filename=""/></div><div>配置：</div><div><br/></div><div><img src="webpack与实际项目的运用_files/Image [77].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [78].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [79].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [80].png" type="image/png" data-filename=""/></div><div>此时，当引入html-loader之后，html-webpack-plugin的titile会失效，取不到，此时将模板index.html改成index.ejs即可，同时，webpack.config.js中也需要改template:index.ejs</div><div><img src="webpack与实际项目的运用_files/Image [81].png" type="image/png" data-filename=""/></div><div>同时，inject应该设置为&quot;body&quot;，如果是head，<span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(20, 25, 30); font-family: 'PingFang SC', 微软雅黑, 'Microsoft YaHei', Helvetica, 'Helvetica Neue', Tahoma, Arial, sans-serif;">那在js执行时是取不到id为app的dom的</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(20, 25, 30); font-family: 'PingFang SC', 微软雅黑, 'Microsoft YaHei', Helvetica, 'Helvetica Neue', Tahoma, Arial, sans-serif;">这样就可以了</span></div><div><br/></div><div><br/></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(20, 25, 30); font-family: 'PingFang SC', 微软雅黑, 'Microsoft YaHei', Helvetica, 'Helvetica Neue', Tahoma, Arial, sans-serif;">如果是layer.ejs模板，</span></div><div><img src="webpack与实际项目的运用_files/Image [82].png" type="image/png" data-filename="" style="font-family: PingFang SC;"/></div><div>安装ejs-loader,   npm install ejs-loader --save-dev</div><div>配置</div><div><img src="webpack与实际项目的运用_files/Image [83].png" type="image/png" data-filename=""/></div><div><br/></div><div><img src="webpack与实际项目的运用_files/Image [84].png" type="image/png" data-filename=""/></div><div><br/></div><div><img src="webpack与实际项目的运用_files/Image [85].png" type="image/png" data-filename=""/></div><div><br/></div></blockquote><div><br/></div><div><br/></div><div><br/></div><div style="text-align: center;"><span style="font-size: 14pt;">处理图片以及其他文件</span></div><div><br/></div><div><ol start="19"><li>在css中指定图片----添加文件夹以及图片</li></ol></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><img src="webpack与实际项目的运用_files/Image [86].png" type="image/png" data-filename=""/></div><div>使用图片</div><div><img src="webpack与实际项目的运用_files/Image [87].png" type="image/png" data-filename=""/></div><div>安装loader，npm-install file-loader --save-dev</div><div><img src="webpack与实际项目的运用_files/Image [88].png" type="image/png" data-filename=""/></div><div>配置：</div><div><img src="webpack与实际项目的运用_files/Image [89].png" type="image/png" data-filename=""/></div><div>webpack</div><div><img src="webpack与实际项目的运用_files/Image [90].png" type="image/png" data-filename=""/></div><div><br/></div></blockquote><div><br/></div><div><br/></div><div><br/></div><div><ol start="20"><li>在项目的根目录下，模板文件index.html中引入图片</li></ol></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><img src="webpack与实际项目的运用_files/Image [91].png" type="image/png" data-filename=""/></div><div>这样也是可以的，所以无论在哪引入图片，都会被loader直接处理</div><div><br/></div></blockquote><div><ol start="21"><li>在layer.ejs中用相对路径引入图片，会发现在浏览器中显示不出来</li></ol></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><img src="webpack与实际项目的运用_files/Image [92].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [93].png" type="image/png" data-filename=""/></div><div><br/></div><div>怎么处理呢？</div><div>继续使用相对路径的话：</div><div><img src="webpack与实际项目的运用_files/Image [94].png" type="image/png" data-filename=""/></div><div><br/></div><div>换成使用绝对路径</div><div><img src="webpack与实际项目的运用_files/Image [95].png" type="image/png" data-filename=""/></div></blockquote><div><br/></div><div><br/></div><div><br/></div><div><ol start="22"><li>如何改变图片的默认输出路径dist/</li></ol></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><img src="webpack与实际项目的运用_files/Image [96].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [97].png" type="image/png" data-filename=""/></div><div><img src="webpack与实际项目的运用_files/Image [98].png" type="image/png" data-filename=""/></div></blockquote><div><ol start="23"><li>url-loader,npm install url-loader --save-dev</li></ol></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div>与file-loader类似，但可以指定limit参数，当图片或文件大小超过limit后，再丢给file loader处理，当小于limit时，会将图片或文件转为一个编码，就不再是url了</div><div><img src="webpack与实际项目的运用_files/Image [99].png" type="image/png" data-filename=""/></div><div>dog.jpg大小为145KB，则将limit设置为200000（200KB），此时webpack试试</div><div>之前</div><div><img src="webpack与实际项目的运用_files/Image [100].png" type="image/png" data-filename=""/></div><div>之后</div><div><img src="webpack与实际项目的运用_files/Image [101].png" type="image/png" data-filename=""/></div><div>发现图片没有再打包了，但现在文件大小却变大很多，这是因为图片的数据编码已经被打包进文件了</div><div>此时在浏览器中，查看img  url（这时layer.ejs的img路径为相对路径）</div><div><img src="webpack与实际项目的运用_files/Image [102].png" type="image/png" data-filename=""/></div><div>包括.layer &gt;div</div><div><img src="webpack与实际项目的运用_files/Image [103].png" type="image/png" data-filename=""/></div></blockquote><div><br/></div><div><br/></div><div><ol start="24"><li>image-webpack-loader 安装</li></ol></div><div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div>配置：</div><div><img src="webpack与实际项目的运用_files/Image [104].png" type="image/png" data-filename=""/></div><div>打包，发现图片被压缩了</div></blockquote></div><div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><img src="webpack与实际项目的运用_files/Image [105].png" type="image/png" data-filename=""/></div></blockquote></div><div>            </div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 